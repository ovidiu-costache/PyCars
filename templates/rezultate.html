{% extends 'base.html' %}

{% block content %}
    
    <div class="container">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h1 style="border-left: 5px solid #2ecc71; padding-left: 10px;">Rezultatele Cautarii</h1>
            <a href="/" class="btn-post" style="background-color: #7f8c8d; text-decoration: none;">&laquo; Filtre Noi</a>
        </div>

        <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); display: flex; justify-content: flex-end; align-items: center;">
            
            <form action="/cautare" method="GET" style="display: flex; align-items: center; gap: 10px; margin: 0;">
                
                <!-- aici practic iau url si-l impart in bucati (filtrele puse de mine de pe pagina home) si le fac hidden
                     pentru ca daca vreau sa mai sortez o data, imi trebuie si filtrele initiale
                     key: model -> value: BMW -->
                {% for key, value in request.args.items() %}
                    {% if key != 'sortare' %}
                        <input type="hidden" name="{{ key }}" value="{{ value }}">
                    {% endif %}
                {% endfor %}

                <label style="font-weight: bold; color: #555;">Sortează după:</label>
                
                <!-- folosim niste javascript "onchange" care cum modifici o sortare, se aplica
                     este in url un element de sortare pe acela il urmeaza -->
                <select name="sortare" onchange="this.form.submit()" style="padding: 8px; border: 1px solid #ddd; border-radius: 4px; background-color: #f8f9fa;">
                    <option value="0">Relevanță (Standard)</option>
                    
                    <!-- aici dupa ce am selectat la sortare, sus la url se va pune acel mod de sortare
                         sortare="pret_cresc", iar eu fac ca acel argument sa ramana setat folosind "selected" -->
                    <option value="pret_cresc" {% if request.args.get('sortare') == 'pret_cresc' %}selected{% endif %}>
                        Preț: Crescător
                    </option>
                    <option value="pret_desc" {% if request.args.get('sortare') == 'pret_desc' %}selected{% endif %}>
                        Preț: Descrescător
                    </option>
                    <option value="an_desc" {% if request.args.get('sortare') == 'an_desc' %}selected{% endif %}>
                        An: Cele mai noi
                    </option>
                    <option value="an_cresc" {% if request.args.get('sortare') == 'an_cresc' %}selected{% endif %}>
                        An: Cele mai vechi
                    </option>
                    <option value="km_cresc" {% if request.args.get('sortare') == 'km_cresc' %}selected{% endif %}>
                        Kilometraj: Mic la Mare
                    </option>
                </select>
            </form>
        </div>

        {% if anunturi %}
            
            <div class="grid-anunturi">
                
                {% for anunt in anunturi %}
                <div class="card">
                    <img src="https://images.unsplash.com/photo-1533473359331-0135ef1b58bf?auto=format&fit=crop&w=500&q=60" class="card-img-top">
                    
                    <div class="card-body">
                        <h3 class="card-title">{{ anunt.title }}</h3>
                        
                        <div class="card-details">
                            <span>{{ anunt.year }}</span> | 
                            <span>{{ anunt.engine.power_hp }} CP</span> | 
                            <span>{{ anunt.engine.fuel_type }}</span>
                        </div>
                        
                        <div class="card-price">{{ anunt.price }} €</div>
                        
                        <br>
                        <a href="/anunt/{{ anunt.id }}" class="btn-detalii">Vezi detalii</a>
                    </div>
                </div>
                {% endfor %}

            </div>

        {% else %}
            <div style="text-align: center; padding: 50px; background-color: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                <h2 style="color: #000000ff;"> Nu am gasit niciun rezultat :(</h2>
                <br>
            </div>
        {% endif %}

    </div>

{% endblock %}